<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Breaking Buggs â€” AI Debugging Agent (Gemini)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  body{
    margin:0; padding:0;
    font-family:'Poppins',sans-serif;
    background: linear-gradient(135deg,#4e54c8,#8f94fb);
    display:flex; justify-content:center; align-items:center;
    min-height:100vh;
  }
  .app{
    width:650px; max-width:95%;
    backdrop-filter: blur(20px);
    background: rgba(255,255,255,0.15);
    border-radius:25px;
    padding:20px;
    box-shadow:0 10px 50px rgba(0,0,0,0.35);
  }
  .header{
    text-align:center; color:#fff; margin-bottom:15px;
  }
  .header .logo{ font-size:48px; animation:spinLogo 3s linear infinite; }
  .header .title{ font-size:28px; font-weight:700; margin-top:6px; }

  .messages{
    height:450px; overflow-y:auto;
    padding:15px;
    display:flex; flex-direction:column; gap:10px;
  }

  .msg{
    max-width:80%; padding:12px 14px; border-radius:18px;
    white-space:pre-wrap;
  }

  .agent{ background:#ffffffaa; color:#111; align-self:flex-start; }
  .user{ background:#4e54c8; color:#fff; align-self:flex-end; }

  .controls{
    display:flex; margin-top:15px; align-items:center; gap:10px;
  }

  #input{
    flex:1; padding:12px; border-radius:12px; border:none;
    outline:none; resize:none;
  }

  button{
    padding:12px 18px; background:#111; color:#fff; border:none;
    border-radius:12px; cursor:pointer;
  }

  .mic{ background:#000; padding:12px 14px; }

  .copy{
    background:#000; color:#fff; padding:5px 10px; border-radius:10px;
    font-size:12px; float:right; cursor:pointer; margin-bottom:5px;
  }

  .typing{
    opacity:0.7;
    font-style:italic;
  }

</style>
</head>
<body>

<div class="app">
  <div class="header">
    <div class="logo">ðŸŒ¸</div>
    <div class="title">Breaking Buggs â€” AI Debugging Agent</div>
  </div>

  <div id="messages" class="messages"></div>

  <div class="controls">
    <textarea id="input" rows="1" placeholder="Paste code or type a query..."></textarea>
    <button onclick="sendMsg()">Send</button>
    <button class="mic" onclick="startMic()">ðŸŽ¤</button>
  </div>
</div>


<script>
const API_KEY = ;
const MODEL  = "gemini-2.0-flash";

const messages = document.getElementById("messages");
const inputEl = document.getElementById("input");

// Auto-resize input
inputEl.addEventListener("input", ()=>{
  inputEl.style.height = "auto";
  inputEl.style.height = inputEl.scrollHeight + "px";
});

function scrollBottom(){
  messages.scrollTop = messages.scrollHeight;
}

function addMsg(html, who="agent"){
  const div = document.createElement("div");
  div.className = `msg ${who}`;
  div.innerHTML = html;
  messages.appendChild(div);
  scrollBottom();
}

function showTyping(){
  const div = document.createElement("div");
  div.id = "typing";
  div.className = "msg agent typing";
  div.innerText = "Typing...";
  messages.appendChild(div);
  scrollBottom();
}

function hideTyping(){
  const t = document.getElementById("typing");
  if(t) t.remove();
}

// Copy code text
function copyCode(btn){
  const code = btn.parentElement.querySelector("pre").innerText;
  navigator.clipboard.writeText(code);
  btn.innerText = "Copied!";
  setTimeout(()=>btn.innerText="Copy", 1500);
}

// Convert ``` blocks to HTML with copy
function parseCode(text){
  if(!text.includes("```")) return text;

  const parts = text.split("```");
  let final = "";

  for(let i=0;i<parts.length;i++){
    if(i % 2 === 0){
      final += `<p>${parts[i]}</p>`;
    } else {
      final += `
        <div>
          <div class="copy" onclick="copyCode(this)">Copy</div>
          <pre>${parts[i].replace(/</g,"&lt;")}</pre>
        </div>
      `;
    }
  }
  return final;
}

async function sendMsg(){
  const text = inputEl.value.trim();
  if(!text) return;

  addMsg(text, "user");
  inputEl.value = "";
  inputEl.style.height = "auto";

  showTyping();

  try{
    const res = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`,
      {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({
          contents: [{ role:"user", parts:[{text:text}] }]
        })
      }
    );

    const data = await res.json();
    hideTyping();

    const reply = data?.candidates?.[0]?.content?.parts?.[0]?.text || "(No response)";
    addMsg(parseCode(reply));

  } catch(err){
    hideTyping();
    addMsg("âŒ Error: "+err.message);
  }
}

// Voice Input
function startMic(){
  const rec = new webkitSpeechRecognition();
  rec.lang = "en-US";
  rec.onresult = (e)=>{
    inputEl.value = e.results[0][0].transcript;
    inputEl.style.height = "auto";
  };
  rec.start();
}
</script>

</body>
</html>
